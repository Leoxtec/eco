<!-- localhost/GenTextures -->
<html>

<head>
<title>Generate Textures</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">

<script type="text/javascript" src="gl-matrix-min.js"></script>
<script type="text/javascript" src="webgl-utils.js"></script>
<script type="text/javascript" src="GenTex.js"></script>
<link rel="stylesheet" href="../../jquery-ui-1.10.3/themes/base/minified/jquery-ui.min.css"/>
<script src="../../jquery-ui-1.10.3/jquery-1.9.1.min.js"></script>
<script src="../../jquery-ui-1.10.3/ui/minified/jquery-ui.min.js"></script>

<script type="text/javascript">

	var gl;
	var canvas;
	var tree;

	function drawScene() {
		gl.viewport(0, 0, gl.viewportWidth, gl.viewportHeight);
		gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);

		tree.renderTree();
	}

	done = false;
	map = false;
	texSentCount = 0;
	texSavedCount = 0;
	function tick() {
		if(!map) {
			requestAnimFrame(tick);
			drawScene();
		}
		else if(!done) {
			requestAnimFrame(tick);
			drawScene();
			texSentCount++;
			done = true;
		}
		else if(texSentCount == texSavedCount) {
			console.log("DONE!");
			window.open('','_self').close();
		}
		else {
			requestAnimFrame(tick);
		}

	}

	function webGLStart() {
		canvas = document.getElementById("canvas");
		gl = WebGLUtils.setupWebGL(canvas);
		if(!gl) {
			return;
		}
		gl.viewportWidth = canvas.width;
		gl.viewportHeight = canvas.height;
		gl.clearColor(0.0, 0.0, 0.0, 0.0);
		gl.enable(gl.DEPTH_TEST);

		tree = new GenTex(gl, canvas, 'point_pick_test_sep');
		tree.root('r');

		tick();
	}

</script>

</head>

<body onload="webGLStart();">
	<canvas id="canvas" style="border: none; background-color: #000000;" width="512" height="512"></canvas>
</body>

</html>
